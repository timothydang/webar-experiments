import*as i from"three";import f from"three/addons/libs/stats.module.js";import{MindARThree as y}from"mindar-image-three";import"three/addons/loaders/GLTFLoader.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function s(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(e){if(e.ep)return;e.ep=!0;const r=s(e);fetch(e.href,r)}})();const w=n=>{navigator.mediaDevices.getUserMedia=()=>new Promise((c,s)=>{const t=document.createElement("video");t.oncanplay=()=>{const e=document.createElement("button");e.innerHTML="start",e.style.position="fixed",e.style.zIndex=1e4,document.body.appendChild(e),e.addEventListener("click",()=>{const r=t.captureStream();t.play(),document.body.removeChild(e),c(r)})},t.setAttribute("loop",""),t.setAttribute("src",n)})},b=n=>{const c=new i.TextureLoader,s=[];for(let t=0;t<n.length;t++)s.push(new Promise((e,r)=>{c.load(n[t],a=>{e(a)})}));return Promise.all(s)};document.addEventListener("DOMContentLoaded",()=>{let n;(async()=>{w("./assets/mock-videos/mg-logos.mp4"),n=new f,document.body.appendChild(n.dom);const s=new y({container:document.body,imageTargetSrc:"./assets/targets/mg-targets.mind",filterMinCF:1e-4,filterBeta:1e-4,missTolerance:0,warmupTolerance:0,uiScanning:!1,uiLoading:"no",maxTrack:3}),{renderer:t,scene:e,camera:r}=s;t.setPixelRatio(window.devicePixelRatio),t.setSize(window.innerWidth,window.innerHeight);const a=[{name:"p-communicate-directly",url:"./assets/images/p-communicate-directly-typography.png"},{name:"p-in-it-together",url:"./assets/images/p-in-it-together-typography.png"},{name:"p-love-what-you-do",url:"./assets/images/p-love-what-you-do-typography.png"},{name:"p-make-good-choices",url:"./assets/images/p-make-good-choices-typography.png"},{name:"p-make-things-better",url:"./assets/images/p-make-things-better-typography.png"}],h=await b(a.map(o=>o.url));for(let o=0;o<a.length;o++){const u=new i.PlaneGeometry(1,1),d=new i.Mesh(u,new i.MeshBasicMaterial({color:16777215})),g=new i.PlaneGeometry(1,1),m=new i.MeshBasicMaterial({map:h[o],transparent:!0,depthWrite:!1}),p=new i.Mesh(g,m);d.scale.set(1.4,1.4,1.4),o===2&&(d.rotation.z=-Math.PI/4),d.add(p),d.userData.clickable=!0,d.userData.objectName=a[o].name,s.addAnchor(o).group.add(d)}document.body.addEventListener("click",o=>{const u=o.clientX/window.innerWidth*2-1,d=-(o.clientY/window.innerHeight)*2+1,g=new i.Vector2(u,d),m=new i.Raycaster;m.setFromCamera(g,r);const p=m.intersectObjects(e.children,!0);if(p.length>0){let l=p[0].object;for(;l.parent&&!l.userData.clickable;)l=l.parent;l.userData.clickable&&window.open("https://mantelgroup.com.au/our-principles/","_blank")}}),t.setAnimationLoop(()=>{t.render(e,r),n.update()}),await s.start()})()});
