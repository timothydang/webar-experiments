import*as a from"three";import{MindARThree as f}from"mindar-image-three";import"three/addons/loaders/GLTFLoader.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function n(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(e){if(e.ep)return;e.ep=!0;const r=n(e);fetch(e.href,r)}})();const y=l=>{navigator.mediaDevices.getUserMedia=()=>new Promise((i,n)=>{const t=document.createElement("video");t.oncanplay=()=>{const e=document.createElement("button");e.innerHTML="start",e.style.position="fixed",e.style.zIndex=1e4,document.body.appendChild(e),e.addEventListener("click",()=>{const r=t.captureStream();t.play(),document.body.removeChild(e),i(r)})},t.setAttribute("loop",""),t.setAttribute("src",l)})},w=l=>{const i=new a.TextureLoader,n=[];for(let t=0;t<l.length;t++)n.push(new Promise((e,r)=>{i.load(l[t],s=>{e(s)})}));return Promise.all(n)};document.addEventListener("DOMContentLoaded",()=>{let l;(async()=>{y("./assets/mock-videos/mg-logos.mp4");const n=new f({container:document.body,imageTargetSrc:"./assets/targets/mg-targets.mind",filterMinCF:1e-4,filterBeta:1e-4,missTolerance:0,warmupTolerance:0,uiScanning:!1,uiLoading:"no",maxTrack:3}),{renderer:t,scene:e,camera:r}=n;t.setPixelRatio(window.devicePixelRatio),t.setSize(window.innerWidth,window.innerHeight);const s=[{name:"p-communicate-directly",url:"./assets/images/p-communicate-directly-typography.png"},{name:"p-in-it-together",url:"./assets/images/p-in-it-together-typography.png"},{name:"p-love-what-you-do",url:"./assets/images/p-love-what-you-do-typography.png"},{name:"p-make-good-choices",url:"./assets/images/p-make-good-choices-typography.png"},{name:"p-make-things-better",url:"./assets/images/p-make-things-better-typography.png"}],h=await w(s.map(o=>o.url));for(let o=0;o<s.length;o++){const p=new a.PlaneGeometry(1,1),c=new a.Mesh(p,new a.MeshBasicMaterial({color:16777215})),g=new a.PlaneGeometry(1,1),m=new a.MeshBasicMaterial({map:h[o],transparent:!0,depthWrite:!1}),u=new a.Mesh(g,m);c.scale.set(1.4,1.4,1.4),o===2&&(c.rotation.z=-Math.PI/4),c.add(u),c.userData.clickable=!0,c.userData.objectName=s[o].name,n.addAnchor(o).group.add(c)}document.body.addEventListener("click",o=>{const p=o.clientX/window.innerWidth*2-1,c=-(o.clientY/window.innerHeight)*2+1,g=new a.Vector2(p,c),m=new a.Raycaster;m.setFromCamera(g,r);const u=m.intersectObjects(e.children,!0);if(u.length>0){let d=u[0].object;for(;d.parent&&!d.userData.clickable;)d=d.parent;d.userData.clickable&&window.open("https://mantelgroup.com.au/our-principles/","_blank")}}),t.setAnimationLoop(()=>{t.render(e,r),l.update()}),await n.start()})()});
